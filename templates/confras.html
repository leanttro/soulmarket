<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crie Sua Divisão de Valores Grátis | Leanttro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --primary: #1a1a1a; --accent: #d4af37; } 
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        body {
            background: linear-gradient(to bottom, #fafafa 0%, #f5f5f5 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .glass-premium {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.06);
        }

        .input-luxury {
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            border: 2px solid #e5e5e5;
        }

        .input-luxury:focus {
            border-color: #1a1a1a;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            outline: none;
        }

        .btn-submit {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn-submit::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-submit:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.2);
            border-color: #d4af37;
        }

        .btn-submit:active {
            transform: translateY(-1px);
        }

        .label-luxury {
            font-weight: 600;
            letter-spacing: 0.05em;
            color: #1a1a1a;
            text-transform: uppercase;
            font-size: 0.75rem;
        }

        .fade-in {
            animation: fadeInUp 0.8s ease-out forwards;
        }

        .slide-in {
            animation: slideIn 0.8s ease-out forwards;
        }

        .prefix-badge {
            background: linear-gradient(135deg, #f9f9f9 0%, #f0f0f0 100%);
            transition: all 0.3s ease;
            border-right: 2px solid #e5e5e5;
        }

        .input-luxury:focus ~ .prefix-badge {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            border-color: #d4af37;
        }

        .luxury-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, #e0e0e0, transparent);
        }

        .success-card {
            background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
            border: 2px solid #e0e0e0;
        }

        .admin-highlight {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 2px solid #d4af37;
        }

        .logo-area {
            position: relative;
        }

        .logo-area::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d4af37, transparent);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

    <div class="w-full max-w-3xl relative z-10">
        
        <!-- Header -->
        <div class="text-center mb-12 logo-area fade-in">
            <h1 class="text-6xl font-light text-gray-900 mb-3 tracking-tight">
                Leanttro
            </h1>
            <p class="text-lg text-gray-500 font-light tracking-wide">
                Plataforma de Gestão de Eventos
            </p>
        </div>

        <!-- Main Card -->
        <div class="glass-premium rounded-2xl shadow-2xl p-12 fade-in" style="animation-delay: 0.2s;">
            
            <div class="text-center mb-10">
                <h2 class="text-3xl font-light text-gray-900 mb-3">
                    Criar Novo Evento
                </h2>
                <div class="luxury-divider max-w-xs mx-auto my-4"></div>
                <p class="text-gray-600 font-light">
                    Configure sua divisão de valores em minutos
                </p>
            </div>

            <form id="creationForm" class="space-y-8">
                
                <!-- Nome do Evento -->
                <div class="slide-in" style="animation-delay: 0.3s;">
                    <label class="label-luxury block mb-3">Nome do Evento</label>
                    <input 
                        type="text" 
                        id="company_name" 
                        required 
                        class="input-luxury w-full p-4 rounded-lg text-base"
                        placeholder="Confraternização de Fim de Ano"
                    >
                </div>

                <!-- Link Personalizado -->
                <div class="slide-in" style="animation-delay: 0.4s;">
                    <label class="label-luxury block mb-3">Link Personalizado</label>
                    <div class="flex rounded-lg overflow-hidden border-2 border-gray-200 focus-within:border-gray-900 transition-all">
                        <span class="prefix-badge inline-flex items-center px-5 text-gray-600 text-sm font-medium">
                            confras.leanttro.com/festa/
                        </span>
                        <input 
                            type="text" 
                            id="subdomain" 
                            required 
                            placeholder="meu-evento" 
                            class="flex-1 p-4 focus:outline-none text-base font-medium"
                        >
                    </div>
                </div>

                <!-- Chave PIX -->
                <div class="slide-in" style="animation-delay: 0.5s;">
                    <label class="label-luxury block mb-3">Chave PIX</label>
                    <input 
                        type="text" 
                        id="pix_key" 
                        required 
                        class="input-luxury w-full p-4 rounded-lg text-base"
                        placeholder="seu@email.com ou CPF/CNPJ"
                    >
                    <p class="text-xs text-gray-500 mt-2 font-light">
                        Chave para receber os pagamentos dos participantes
                    </p>
                </div>

                <!-- Email -->
                <div class="slide-in" style="animation-delay: 0.6s;">
                    <label class="label-luxury block mb-3">E-mail de Contato</label>
                    <input 
                        type="email" 
                        id="email" 
                        required 
                        class="input-luxury w-full p-4 rounded-lg text-base"
                        placeholder="contato@empresa.com"
                    >
                </div>

                <!-- Senha -->
                <div class="slide-in" style="animation-delay: 0.7s;">
                    <label class="label-luxury block mb-3">Senha de Administrador</label>
                    <input 
                        type="password" 
                        id="password" 
                        required 
                        class="input-luxury w-full p-4 rounded-lg text-base"
                        placeholder="••••••••"
                    >
                    <p class="text-xs text-gray-500 mt-2 font-light">
                        Use esta senha para acessar o painel administrativo
                    </p>
                </div>

                <!-- Submit Button -->
                <button 
                    type="submit" 
                    class="btn-submit w-full py-5 px-6 rounded-lg font-semibold text-white text-base shadow-xl slide-in"
                    style="animation-delay: 0.8s;"
                >
                    <span class="relative z-10 flex items-center justify-center gap-3">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Criar Evento
                    </span>
                </button>
                
                <!-- Message Area -->
                <div id="message" class="mt-8 p-8 rounded-xl text-center hidden"></div>
            </form>
        </div>

        <!-- Footer -->
        <div class="text-center mt-10 fade-in" style="animation-delay: 0.9s;">
            <p class="text-sm text-gray-500 font-light">
                Desenvolvido por <span class="text-gray-900 font-medium">Leanttro Tecnologia</span>
            </p>
        </div>
    </div>
    
    <script>
        document.getElementById('creationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const msg = document.getElementById('message');
            
            const data = {
                company_name: document.getElementById('company_name').value,
                subdomain: document.getElementById('subdomain').value,
                email: document.getElementById('email').value,
                pix_key: document.getElementById('pix_key').value,
                password: document.getElementById('password').value
            };
            
            btn.disabled = true;
            btn.innerHTML = '<span class="relative z-10 flex items-center justify-center gap-2"><svg class="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Processando...</span>';
            
            try {
                const res = await fetch('/api/create_tenant', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                const json = await res.json();
                
                if (json.status === 'success') {
                    const publicLink = json.url; 
                    const adminLink = `${publicLink}?admin=${json.admin_token}`;
                    
                    msg.classList.remove('hidden');
                    msg.className = 'success-card mt-8 p-8 rounded-xl shadow-xl';
                    msg.innerHTML = `
                        <div class="space-y-6">
                            <div class="flex items-center justify-center gap-3 text-2xl font-light text-gray-900">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Evento Criado
                            </div>
                            
                            <div style="height: 1px; background: linear-gradient(90deg, transparent, #e0e0e0, transparent);"></div>
                            
                            <div class="bg-white p-6 rounded-xl border border-gray-200">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-3">Link Público</p>
                                <a href="${publicLink}" target="_blank" class="block font-mono text-sm text-gray-900 hover:text-gray-600 underline break-all transition-colors">${publicLink}</a>
                            </div>
                            
                            <div class="admin-highlight p-6 rounded-xl text-white">
                                <div class="flex items-center gap-2 mb-3">
                                    <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    <p class="text-xs font-semibold uppercase tracking-widest text-amber-400">Link Administrativo</p>
                                </div>
                                <p class="text-xs text-gray-300 mb-3 font-light">Salve este link com segurança. Use-o para gerenciar pagamentos:</p>
                                <a href="${adminLink}" target="_blank" class="block font-mono text-xs text-white hover:text-amber-400 underline break-all transition-colors">${adminLink}</a>
                            </div>

                            <div class="bg-gray-50 border border-gray-200 p-5 rounded-xl">
                                <p class="text-sm text-gray-700 font-light leading-relaxed">
                                    <strong class="font-semibold">Próximo passo:</strong> Compartilhe o link público com seus convidados e utilize o link administrativo para aprovar os pagamentos.
                                </p>
                            </div>
                        </div>
                    `;
                    e.target.reset();
                    
                    // Scroll to message
                    msg.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    throw new Error(json.message);
                }
            } catch (err) {
                msg.classList.remove('hidden');
                msg.className = 'mt-8 p-6 rounded-xl bg-gradient-to-r from-gray-50 to-gray-100 border-l-4 border-gray-900';
                msg.innerHTML = `
                    <div class="flex items-center gap-3">
                        <svg class="w-6 h-6 text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="font-semibold text-gray-900">Erro ao criar evento</p>
                            <p class="text-sm text-gray-600 mt-1">${err.message || 'Tente novamente em alguns instantes.'}</p>
                        </div>
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<span class="relative z-10 flex items-center justify-center gap-3"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>Criar Evento</span>';
            }
        });

        // Smooth input animations
        document.querySelectorAll('.input-luxury').forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.style.transform = 'scale(1.01)';
            });
            
            input.addEventListener('blur', function() {
                this.parentElement.style.transform = 'scale(1)';
            });
        });
    </script>
</body>
</html>